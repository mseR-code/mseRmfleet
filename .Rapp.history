source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
H2
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
dev.off()
dev.off()
dev.off()
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
?label
?text
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
rho1 <- atan2(c(d,H1))
?atan2
rho1 <- atan2(d,H1)
rho1
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
rho1
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/Plots/makeBuoyLineDiagram.R")
source("/Users/sdnjohnson/Work/Consulting/FASSeafoods/DFOViolation/Data/makeDriftDistributions.R")
head(violationEventsOSCAR)
# <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>#
# makeDriftDistributions.R#
# #
# Author: Samuel Johnson#
# #
# This script creates drift distributions for closed area report sets#
# using two different assumptions.#
# #
# 1. Current provided by the OSCAR data set is correct#
# 2. Currents provided by Dr Masson are correct#
# #
# Created Apr 26, 2018#
# #
# <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>#
#
source("msertools.R")#
# Load packages#
library( dplyr )#
library( stringr )#
library( raster )#
library( sp )#
library( rgdal )#
library( rgeos )#
library( geosphere )#
library( ggmap )#
library( maptools )#
library( rgdal )#
library( PBSmapping ) #
library( RColorBrewer )#
library( plotrix )#
library( grid )#
library( viridis )#
library( autoimage )#
library( SDMTools )#
library( fifer )#
#
crsAEA <- "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"#
lonLatCRS <- "+proj=longlat +ellps=WGS84 +no_defs"#
eezBdry.NOAA <- shapefile(x = "./Shapefiles/cropped/NOAAeez/eez_BCAK.shp")#
eezBdry.NOAA.AEA <- spTransform( eezBdry.NOAA, CRSobj = crsAEA )#
# create a function for dplyring these massive sets#
pullFirst <- function( x ) x[1]#
pullLast <- function( x ) x[length(x)]#
#
# First, load data, calculate the width of the drift bands for each set#
violationEventsOSCAR <- read.csv( "violation_BuoyLines_OSCAR.csv", header =T,#
                                  stringsAsFactors = FALSE  )#
#
# Convert LL to AEA for easier plotting#
violationEvents.LL <- violationEventsOSCAR[,c("lon","lat")]#
violationEvents.sp <- SpatialPoints(coords = violationEvents.LL, proj4string = CRS(lonLatCRS) )#
violationEvents.AEA <- as.data.frame(spTransform( x = violationEvents.sp, CRSobj = crsAEA ))#
#
violationEventsOSCAR$x <- violationEvents.AEA[,1]#
violationEventsOSCAR$y <- violationEvents.AEA[,2]#
#
# Get full range of violation#
xRange.viol <- range(violationEventsOSCAR$x)#
yRange.viol <- range(violationEventsOSCAR$y)#
violationSetsOSCAR <- violationEventsOSCAR %>%#
                      filter( type == "Set" ) %>%#
                      group_by( eventID ) %>%#
                      summarise(  lat.start = pullFirst(lat),#
                                  lon.start = pullFirst(lon),#
                                  x.start = pullFirst(x),#
                                  y.start = pullFirst(y),#
                                  lat.end = pullLast(lat),#
                                  lon.end = pullLast(lon),#
                                  x.end = pullLast(x),#
                                  y.end = pullLast(y),#
                                  depth = mean(depth),#
                                  r = mean(r),#
                                  r.var = mean(r.var),#
                                  Theta = mean(Theta),#
                                  Theta.var = mean(Theta.var),#
                                  currHeading = mean(currHeading),#
                                  minRad.start = pullFirst(minHzDist),#
                                  maxRad.start = pullFirst(maxHzDist),#
                                  minRad.end = pullLast(minHzDist),#
                                  maxRad.end = pullLast(maxHzDist),) %>%#
                      ungroup() %>%#
                      mutate( sinkTime = depth / 0.385,#
                              meanDriftDist = r * sinkTime,#
                              upperDriftDist = (r + 1.96*sqrt(r.var))*sinkTime,#
                              lowerDriftDist = (r - 1.96*sqrt(r.var))*sinkTime  )
head(violationSetsOSCAR)
head(violationSetsOSCAR[,c("minRad.start","maxRad.start","minRad.end","maxRad.end")])
range(violationSetsOSCAR[,c("minRad.start","maxRad.start","minRad.end","maxRad.end")])
source("mser.r")
guiView()
